---
alwaysApply: true
---

# üß† Service

Services cont√™m a l√≥gica de neg√≥cio da aplica√ß√£o. S√£o respons√°veis por validar dados, aplicar regras do dom√≠nio e interagir com reposit√≥rios.

---

## ‚úÖ Regras

- N√£o acessa diretamente o banco (usa reposit√≥rios).
- Lan√ßa exce√ß√µes com `CustomHttpException`.
- Utiliza `ErrorMessagesService` para mensagens padronizadas.
- Pode fazer valida√ß√µes com base nas regras do neg√≥cio.
- Todo service deve **usar** `import { Logger } from '@nestjs/common';` para registrar logs de acompanhamento.
- O c√≥digo deve sempre ter **linhas vazias entre blocos l√≥gicos**, para manter a legibilidade e facilitar a manuten√ß√£o.

---

## üìå Exemplo

```ts
import { Injectable, Logger } from '@nestjs/common';
import { ErrorMessagesService } from '@/core/error-message.service';
import { CustomHttpException } from '@/core/exceptions/custom-http.exception';
import { EmployeeRequestDTO, EmployeeResponseDTO } from '../dtos';
import { IEmployeeRepository } from '../contracts';
import { ErrorCode } from '@/core/constants';
import { HttpStatus } from '@nestjs/common';

@Injectable()
export class EmployeeCreateService {
  constructor(
    private readonly employeeRepository: IEmployeeRepository,
    private readonly errorMessagesService: ErrorMessagesService,
    private readonly logger: Logger,
  ) {}

  async execute(dto: EmployeeRequestDTO, ownerId: number): Promise<EmployeeResponseDTO> {
    const establishment = await this.employeeRepository.findEstablishmentById(dto.establishmentId, ownerId);

    if (!establishment) {
      const message = this.errorMessagesService.getMessage(
        ErrorCode.ESTABLISHMENT_NOT_FOUND_OR_ACCESS_DENIED,
        {
          ESTABLISHMENT_ID: dto.establishmentId,
          OWNER_ID: ownerId,
        },
      );

      this.logger.warn(message);

      throw new CustomHttpException(
        message,
        HttpStatus.NOT_FOUND,
        ErrorCode.ESTABLISHMENT_NOT_FOUND_OR_ACCESS_DENIED,
      );
    }

    const employee = await this.employeeRepository.createEmployee(dto);

    this.logger.log(`Funcion√°rio criado com ID: ${employee.id}`);

    return employee;
  }
}
